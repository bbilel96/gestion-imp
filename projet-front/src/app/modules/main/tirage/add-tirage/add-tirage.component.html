<p-messages></p-messages>
<div  *ngIf="fileStatus.status==='progress'">

<p-progressBar  [value]="fileStatus.percent"></p-progressBar>

</div>
<h5>Ajouter une nouvelle demande de tirage</h5>




<form (ngSubmit)="onSubmit()" [formGroup]="addTirageForm">
  <div class="grid">



    <div class="p-field col-12 lg:col-6 xl:col-6 ">
      <label class="mb-2"  style="display: block">Choisir une matiere</label>

      <p-dropdown  (onChange)="miseAJourClasse($event)" [ngClass]="{ 'ng-invalid ng-dirty': validation.inputError(responseMessage.validations, 'matiereId').length != 0}" placeholder="Selectionner une matiÃ¨re" optionLabel="nom" formControlName="matiereDto" [options]="affectedMatiere" ></p-dropdown>
      <small *ngFor="let error of validation.inputError(responseMessage.validations, 'matiereId')" class="p-error block"
             id="type-error">
        {{error.errorMessage}}
      </small>
    </div>
    <div class="p-field col-12 lg:col-6 xl:col-6 ">
      <label class="mb-2"  style="display: block">Choisir une classe </label>

      <p-dropdown   [ngClass]="{ 'ng-invalid ng-dirty': validation.inputError(responseMessage.validations, 'classeId').length != 0}" [options]="affectClasse" placeholder="Selectionner une classe" optionLabel="nom" formControlName="classeDto" ></p-dropdown>
      <small *ngFor="let error of validation.inputError(responseMessage.validations, 'classeId')" class="p-error block"
             id="classe-error">
        {{error.errorMessage}}
      </small>
    </div>

    <div class="p-field col-12 lg:col-6 xl:col-6  ">
      <label class="mb-2" for="nom" style="display: block">Nombre  de copie</label>

      <input class="w-full" formControlName="nbTirage" id="nom" pInputText placeholder="Nombre de copie" type="text" [ngClass]="{ 'ng-invalid ng-dirty': validation.inputError(responseMessage.validations, 'nbTirage').length != 0}"/>
      <small *ngFor="let error of validation.inputError(responseMessage.validations, 'nbTirage')" class="p-error block"
             id="email-error">
        {{error.errorMessage}}
      </small>
    </div>
    <div class="p-field col-12 lg:col-6 xl:col-6 ">

      <label class="mb-2" for="dateNasiss" style="display: block">Date impression</label>
      <p-calendar placeholder="Date de tirage" formControlName= "dateImpression" [showTime]="true" dateFormat="mm-dd-yy" class="w-full" id="dateNasiss"  [ngClass]="{ 'ng-invalid ng-dirty': validation.inputError(responseMessage.validations, 'dateImpression').length != 0}"inputId="dateformat"></p-calendar>
      <small *ngFor="let error of validation.inputError(responseMessage.validations, 'dateImpression')" class="p-error block"
             id="date-error">
        {{error.errorMessage}}
      </small>
    </div>

  </div>

  <div class="grid">
    <div class="p-field col-12  ">
      <label class="mb-2" for="dateNasiss" style="display: block">Fichier </label>
      <p-fileUpload chooseLabel="Choisir un fichier" (onSelect)="onSelect($event)" (onRemove)="onRemove($event)" cancelLabel= "Annuler" [showUploadButton]="false"></p-fileUpload>
      <small *ngFor="let error of validation.inputError(responseMessage.validations, 'dateNaissance')" class="p-error block"
             id="ficher-error">
        {{error.errorMessage}}
      </small>
    </div>

  </div>

  <div class="grid mt-3">
    <div class=" col-12  md:col-3 lg:col-2 col-offset-0 md:col-offset-9 lg:col-offset-10 lg:px-2">
      <button [disabled]="submitButton || uploadedFiles == null || uploadedFiles == undefined" class="w-full" label="Ajouter" pButton></button>
    </div>
  </div>

</form>




